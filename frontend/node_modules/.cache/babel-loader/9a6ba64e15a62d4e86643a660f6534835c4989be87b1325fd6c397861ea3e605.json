{"ast":null,"code":"// Payment Service with Auto-detection and Gateway Integration\nclass PaymentService {\n  constructor() {\n    this.upiId = 'sangita.shreyas@paytm'; // Your UPI ID\n    this.merchantName = 'Stitch & Savour';\n    this.supportedGateways = ['razorpay', 'phonepe', 'paytm', 'gpay'];\n  }\n\n  // Generate dynamic UPI payment URL with amount\n  generateUPIUrl(amount, orderId, customerName) {\n    const params = new URLSearchParams({\n      pa: this.upiId,\n      pn: this.merchantName,\n      tr: orderId,\n      tn: `Payment for Order ${orderId} - ${customerName}`,\n      am: amount.toString(),\n      cu: 'INR',\n      mc: '5411' // Merchant category code for grocery stores\n    });\n    return `upi://pay?${params.toString()}`;\n  }\n\n  // Generate QR code data URL\n  async generateQRCode(amount, orderId, customerName) {\n    const upiUrl = this.generateUPIUrl(amount, orderId, customerName);\n    try {\n      // Using QR Server API for dynamic QR generation\n      const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(upiUrl)}`;\n      return qrApiUrl;\n    } catch (error) {\n      console.error('QR generation error:', error);\n      return null;\n    }\n  }\n\n  // Auto-detect available payment apps\n  detectPaymentApps() {\n    const apps = [];\n    const userAgent = navigator.userAgent.toLowerCase();\n\n    // Check for installed UPI apps (basic detection)\n    const appChecks = [{\n      name: 'PhonePe',\n      package: 'phonepe',\n      url: 'phonepe://'\n    }, {\n      name: 'Google Pay',\n      package: 'gpay',\n      url: 'tez://'\n    }, {\n      name: 'Paytm',\n      package: 'paytm',\n      url: 'paytmmp://'\n    }, {\n      name: 'BHIM',\n      package: 'bhim',\n      url: 'bhim://'\n    }, {\n      name: 'Amazon Pay',\n      package: 'amazonpay',\n      url: 'amazonpay://'\n    }];\n    appChecks.forEach(app => {\n      apps.push({\n        ...app,\n        available: true,\n        // In real implementation, check if app is installed\n        icon: `/images/payment-icons/${app.package}.png`\n      });\n    });\n    return apps;\n  }\n\n  // Launch specific payment app\n  launchPaymentApp(appUrl, amount, orderId, customerName) {\n    const upiUrl = this.generateUPIUrl(amount, orderId, customerName);\n\n    // Try to open the specific app\n    const appSpecificUrl = appUrl.replace('://', `://upi/pay?${new URL(upiUrl).search.substring(1)}`);\n    try {\n      window.location.href = appSpecificUrl;\n\n      // Fallback to generic UPI URL after 2 seconds\n      setTimeout(() => {\n        window.location.href = upiUrl;\n      }, 2000);\n    } catch (error) {\n      // Fallback to generic UPI URL\n      window.location.href = upiUrl;\n    }\n  }\n\n  // Initialize Razorpay (if you want to integrate)\n  async initializeRazorpay(amount, orderId, customerInfo) {\n    if (!window.Razorpay) {\n      // Load Razorpay script dynamically\n      await this.loadScript('https://checkout.razorpay.com/v1/checkout.js');\n    }\n    const options = {\n      key: 'YOUR_RAZORPAY_KEY',\n      // Replace with your Razorpay key\n      amount: amount * 100,\n      // Amount in paise\n      currency: 'INR',\n      name: this.merchantName,\n      description: `Order ${orderId}`,\n      order_id: orderId,\n      handler: response => {\n        this.handlePaymentSuccess(response);\n      },\n      prefill: {\n        name: customerInfo.name,\n        email: customerInfo.email,\n        contact: customerInfo.phone\n      },\n      theme: {\n        color: '#8B5CF6'\n      }\n    };\n    const rzp = new window.Razorpay(options);\n    rzp.open();\n  }\n\n  // Load external script\n  loadScript(src) {\n    return new Promise((resolve, reject) => {\n      const script = document.createElement('script');\n      script.src = src;\n      script.onload = resolve;\n      script.onerror = reject;\n      document.head.appendChild(script);\n    });\n  }\n\n  // Handle payment success\n  handlePaymentSuccess(response) {\n    console.log('Payment successful:', response);\n    // Trigger success callback\n    if (this.onPaymentSuccess) {\n      this.onPaymentSuccess(response);\n    }\n  }\n\n  // Verify payment status (mock implementation)\n  async verifyPayment(transactionId) {\n    // In real implementation, call your backend to verify payment\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve({\n          success: true,\n          transactionId,\n          status: 'completed'\n        });\n      }, 2000);\n    });\n  }\n\n  // Check payment status periodically\n  startPaymentStatusCheck(orderId, callback) {\n    const checkInterval = setInterval(async () => {\n      try {\n        // In real implementation, check with your backend\n        const status = await this.checkPaymentStatus(orderId);\n        if (status.completed) {\n          clearInterval(checkInterval);\n          callback(true);\n        }\n      } catch (error) {\n        console.error('Payment status check error:', error);\n      }\n    }, 3000); // Check every 3 seconds\n\n    // Stop checking after 5 minutes\n    setTimeout(() => {\n      clearInterval(checkInterval);\n    }, 300000);\n    return checkInterval;\n  }\n\n  // Mock payment status check\n  async checkPaymentStatus(orderId) {\n    // In real implementation, call your backend API\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve({\n          completed: Math.random() > 0.7,\n          // 30% chance of completion for demo\n          orderId,\n          timestamp: new Date().toISOString()\n        });\n      }, 1000);\n    });\n  }\n}\nexport default new PaymentService();","map":{"version":3,"names":["PaymentService","constructor","upiId","merchantName","supportedGateways","generateUPIUrl","amount","orderId","customerName","params","URLSearchParams","pa","pn","tr","tn","am","toString","cu","mc","generateQRCode","upiUrl","qrApiUrl","encodeURIComponent","error","console","detectPaymentApps","apps","userAgent","navigator","toLowerCase","appChecks","name","package","url","forEach","app","push","available","icon","launchPaymentApp","appUrl","appSpecificUrl","replace","URL","search","substring","window","location","href","setTimeout","initializeRazorpay","customerInfo","Razorpay","loadScript","options","key","currency","description","order_id","handler","response","handlePaymentSuccess","prefill","email","contact","phone","theme","color","rzp","open","src","Promise","resolve","reject","script","document","createElement","onload","onerror","head","appendChild","log","onPaymentSuccess","verifyPayment","transactionId","success","status","startPaymentStatusCheck","callback","checkInterval","setInterval","checkPaymentStatus","completed","clearInterval","Math","random","timestamp","Date","toISOString"],"sources":["D:/project1/stitch_and_savour/frontend/src/services/paymentService.js"],"sourcesContent":["// Payment Service with Auto-detection and Gateway Integration\nclass PaymentService {\n  constructor() {\n    this.upiId = 'sangita.shreyas@paytm'; // Your UPI ID\n    this.merchantName = 'Stitch & Savour';\n    this.supportedGateways = ['razorpay', 'phonepe', 'paytm', 'gpay'];\n  }\n\n  // Generate dynamic UPI payment URL with amount\n  generateUPIUrl(amount, orderId, customerName) {\n    const params = new URLSearchParams({\n      pa: this.upiId,\n      pn: this.merchantName,\n      tr: orderId,\n      tn: `Payment for Order ${orderId} - ${customerName}`,\n      am: amount.toString(),\n      cu: 'INR',\n      mc: '5411' // Merchant category code for grocery stores\n    });\n    \n    return `upi://pay?${params.toString()}`;\n  }\n\n  // Generate QR code data URL\n  async generateQRCode(amount, orderId, customerName) {\n    const upiUrl = this.generateUPIUrl(amount, orderId, customerName);\n    \n    try {\n      // Using QR Server API for dynamic QR generation\n      const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(upiUrl)}`;\n      return qrApiUrl;\n    } catch (error) {\n      console.error('QR generation error:', error);\n      return null;\n    }\n  }\n\n  // Auto-detect available payment apps\n  detectPaymentApps() {\n    const apps = [];\n    const userAgent = navigator.userAgent.toLowerCase();\n    \n    // Check for installed UPI apps (basic detection)\n    const appChecks = [\n      { name: 'PhonePe', package: 'phonepe', url: 'phonepe://' },\n      { name: 'Google Pay', package: 'gpay', url: 'tez://' },\n      { name: 'Paytm', package: 'paytm', url: 'paytmmp://' },\n      { name: 'BHIM', package: 'bhim', url: 'bhim://' },\n      { name: 'Amazon Pay', package: 'amazonpay', url: 'amazonpay://' }\n    ];\n\n    appChecks.forEach(app => {\n      apps.push({\n        ...app,\n        available: true, // In real implementation, check if app is installed\n        icon: `/images/payment-icons/${app.package}.png`\n      });\n    });\n\n    return apps;\n  }\n\n  // Launch specific payment app\n  launchPaymentApp(appUrl, amount, orderId, customerName) {\n    const upiUrl = this.generateUPIUrl(amount, orderId, customerName);\n    \n    // Try to open the specific app\n    const appSpecificUrl = appUrl.replace('://', `://upi/pay?${new URL(upiUrl).search.substring(1)}`);\n    \n    try {\n      window.location.href = appSpecificUrl;\n      \n      // Fallback to generic UPI URL after 2 seconds\n      setTimeout(() => {\n        window.location.href = upiUrl;\n      }, 2000);\n    } catch (error) {\n      // Fallback to generic UPI URL\n      window.location.href = upiUrl;\n    }\n  }\n\n  // Initialize Razorpay (if you want to integrate)\n  async initializeRazorpay(amount, orderId, customerInfo) {\n    if (!window.Razorpay) {\n      // Load Razorpay script dynamically\n      await this.loadScript('https://checkout.razorpay.com/v1/checkout.js');\n    }\n\n    const options = {\n      key: 'YOUR_RAZORPAY_KEY', // Replace with your Razorpay key\n      amount: amount * 100, // Amount in paise\n      currency: 'INR',\n      name: this.merchantName,\n      description: `Order ${orderId}`,\n      order_id: orderId,\n      handler: (response) => {\n        this.handlePaymentSuccess(response);\n      },\n      prefill: {\n        name: customerInfo.name,\n        email: customerInfo.email,\n        contact: customerInfo.phone\n      },\n      theme: {\n        color: '#8B5CF6'\n      }\n    };\n\n    const rzp = new window.Razorpay(options);\n    rzp.open();\n  }\n\n  // Load external script\n  loadScript(src) {\n    return new Promise((resolve, reject) => {\n      const script = document.createElement('script');\n      script.src = src;\n      script.onload = resolve;\n      script.onerror = reject;\n      document.head.appendChild(script);\n    });\n  }\n\n  // Handle payment success\n  handlePaymentSuccess(response) {\n    console.log('Payment successful:', response);\n    // Trigger success callback\n    if (this.onPaymentSuccess) {\n      this.onPaymentSuccess(response);\n    }\n  }\n\n  // Verify payment status (mock implementation)\n  async verifyPayment(transactionId) {\n    // In real implementation, call your backend to verify payment\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve({\n          success: true,\n          transactionId,\n          status: 'completed'\n        });\n      }, 2000);\n    });\n  }\n\n  // Check payment status periodically\n  startPaymentStatusCheck(orderId, callback) {\n    const checkInterval = setInterval(async () => {\n      try {\n        // In real implementation, check with your backend\n        const status = await this.checkPaymentStatus(orderId);\n        \n        if (status.completed) {\n          clearInterval(checkInterval);\n          callback(true);\n        }\n      } catch (error) {\n        console.error('Payment status check error:', error);\n      }\n    }, 3000); // Check every 3 seconds\n\n    // Stop checking after 5 minutes\n    setTimeout(() => {\n      clearInterval(checkInterval);\n    }, 300000);\n\n    return checkInterval;\n  }\n\n  // Mock payment status check\n  async checkPaymentStatus(orderId) {\n    // In real implementation, call your backend API\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve({\n          completed: Math.random() > 0.7, // 30% chance of completion for demo\n          orderId,\n          timestamp: new Date().toISOString()\n        });\n      }, 1000);\n    });\n  }\n}\n\nexport default new PaymentService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}