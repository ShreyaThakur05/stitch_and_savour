{"ast":null,"code":"// Excel export utility\nexport const exportToExcel=function(data){let filename=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'export.csv';const csvContent=data.map(row=>Object.values(row).map(value=>typeof value==='string'&&value.includes(',')?\"\\\"\".concat(value,\"\\\"\"):value).join(',')).join('\\n');const headers=Object.keys(data[0]||{}).join(',');const fullContent=headers+'\\n'+csvContent;const blob=new Blob([fullContent],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');const url=URL.createObjectURL(blob);link.setAttribute('href',url);link.setAttribute('download',filename);link.style.visibility='hidden';document.body.appendChild(link);link.click();document.body.removeChild(link);};export const exportOrdersToExcel=orders=>{const exportData=orders.map(order=>{var _order$items,_order$items2,_order$items2$;return{'Order ID':order.orderNumber,'Customer Name':order.customerName,'Email':order.customerEmail||'N/A','Phone':order.phone||'N/A','Total Amount':order.total,'Payment Method':order.paymentMethod==='qr'?'Online':'COD','Payment Status':order.paymentMethod==='qr'?'Paid':'Pending','Order Status':order.status,'Order Date':new Date(order.createdAt).toLocaleDateString(),'Delivery Deadline':new Date(order.estimatedDelivery).toLocaleDateString(),'Items':((_order$items=order.items)===null||_order$items===void 0?void 0:_order$items.map(item=>\"\".concat(item.name,\" (\").concat(item.quantity,\")\")).join('; '))||'N/A','Category':((_order$items2=order.items)===null||_order$items2===void 0?void 0:(_order$items2$=_order$items2[0])===null||_order$items2$===void 0?void 0:_order$items2$.category)||'Mixed'};});exportToExcel(exportData,\"orders_\".concat(new Date().toISOString().split('T')[0],\".csv\"));};","map":{"version":3,"names":["exportToExcel","data","filename","arguments","length","undefined","csvContent","map","row","Object","values","value","includes","concat","join","headers","keys","fullContent","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","exportOrdersToExcel","orders","exportData","order","_order$items","_order$items2","_order$items2$","orderNumber","customerName","customerEmail","phone","total","paymentMethod","status","Date","createdAt","toLocaleDateString","estimatedDelivery","items","item","name","quantity","category","toISOString","split"],"sources":["d:/project1/stitch_and_savour/frontend/src/utils/excelExport.js"],"sourcesContent":["// Excel export utility\nexport const exportToExcel = (data, filename = 'export.csv') => {\n  const csvContent = data.map(row => \n    Object.values(row).map(value => \n      typeof value === 'string' && value.includes(',') ? `\"${value}\"` : value\n    ).join(',')\n  ).join('\\n');\n  \n  const headers = Object.keys(data[0] || {}).join(',');\n  const fullContent = headers + '\\n' + csvContent;\n  \n  const blob = new Blob([fullContent], { type: 'text/csv;charset=utf-8;' });\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};\n\nexport const exportOrdersToExcel = (orders) => {\n  const exportData = orders.map(order => ({\n    'Order ID': order.orderNumber,\n    'Customer Name': order.customerName,\n    'Email': order.customerEmail || 'N/A',\n    'Phone': order.phone || 'N/A',\n    'Total Amount': order.total,\n    'Payment Method': order.paymentMethod === 'qr' ? 'Online' : 'COD',\n    'Payment Status': order.paymentMethod === 'qr' ? 'Paid' : 'Pending',\n    'Order Status': order.status,\n    'Order Date': new Date(order.createdAt).toLocaleDateString(),\n    'Delivery Deadline': new Date(order.estimatedDelivery).toLocaleDateString(),\n    'Items': order.items?.map(item => `${item.name} (${item.quantity})`).join('; ') || 'N/A',\n    'Category': order.items?.[0]?.category || 'Mixed'\n  }));\n  \n  exportToExcel(exportData, `orders_${new Date().toISOString().split('T')[0]}.csv`);\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}