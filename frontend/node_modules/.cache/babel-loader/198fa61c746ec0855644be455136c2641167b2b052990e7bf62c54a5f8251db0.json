{"ast":null,"code":"import _objectSpread from\"d:/project1/stitch_and_savour/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from'axios';import{config}from'../config/config';const API_URL=config.API_URL;const api=axios.create({baseURL:API_URL,headers:{'Content-Type':'application/json'}});// Add token to requests\napi.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;},error=>Promise.reject(error));export const wishlistService={// Add to wishlist - save to both backend and localStorage\naddToWishlist:async(product,userEmail)=>{try{var _product$images;// Try to save to backend first\nconst response=await api.post('/wishlist/add',{productId:product._id,productName:product.name,productPrice:product.price,productImage:((_product$images=product.images)===null||_product$images===void 0?void 0:_product$images[0])||''});// Update localStorage\nconst existingWishlist=JSON.parse(localStorage.getItem(\"wishlist_\".concat(userEmail))||'[]');if(!existingWishlist.find(item=>item._id===product._id)){existingWishlist.push(product);localStorage.setItem(\"wishlist_\".concat(userEmail),JSON.stringify(existingWishlist));}return response.data;}catch(error){// Fallback to localStorage only\nconsole.warn('Backend unavailable, saving to localStorage only:',error.message);const existingWishlist=JSON.parse(localStorage.getItem(\"wishlist_\".concat(userEmail))||'[]');if(!existingWishlist.find(item=>item._id===product._id)){existingWishlist.push(_objectSpread(_objectSpread({},product),{},{isLocal:true}));localStorage.setItem(\"wishlist_\".concat(userEmail),JSON.stringify(existingWishlist));}return{success:true};}},// Remove from wishlist\nremoveFromWishlist:async(productId,userEmail)=>{try{await api.delete(\"/wishlist/remove/\".concat(productId));// Update localStorage\nconst existingWishlist=JSON.parse(localStorage.getItem(\"wishlist_\".concat(userEmail))||'[]');const updatedWishlist=existingWishlist.filter(item=>item._id!==productId);localStorage.setItem(\"wishlist_\".concat(userEmail),JSON.stringify(updatedWishlist));return{success:true};}catch(error){// Fallback to localStorage only\nconst existingWishlist=JSON.parse(localStorage.getItem(\"wishlist_\".concat(userEmail))||'[]');const updatedWishlist=existingWishlist.filter(item=>item._id!==productId);localStorage.setItem(\"wishlist_\".concat(userEmail),JSON.stringify(updatedWishlist));return{success:true};}},// Get user wishlist\ngetUserWishlist:async userEmail=>{try{const response=await api.get('/wishlist');// Merge with localStorage\nconst localWishlist=JSON.parse(localStorage.getItem(\"wishlist_\".concat(userEmail))||'[]');const backendIds=response.data.wishlist.map(item=>item._id);const localOnlyItems=localWishlist.filter(item=>!backendIds.includes(item._id));return[...response.data.wishlist,...localOnlyItems];}catch(error){console.warn('Backend unavailable, using localStorage:',error.message);return JSON.parse(localStorage.getItem(\"wishlist_\".concat(userEmail))||'[]');}}};export default wishlistService;","map":{"version":3,"names":["axios","config","API_URL","api","create","baseURL","headers","interceptors","request","use","token","localStorage","getItem","Authorization","concat","error","Promise","reject","wishlistService","addToWishlist","product","userEmail","_product$images","response","post","productId","_id","productName","name","productPrice","price","productImage","images","existingWishlist","JSON","parse","find","item","push","setItem","stringify","data","console","warn","message","_objectSpread","isLocal","success","removeFromWishlist","delete","updatedWishlist","filter","getUserWishlist","get","localWishlist","backendIds","wishlist","map","localOnlyItems","includes"],"sources":["d:/project1/stitch_and_savour/frontend/src/services/wishlistService.js"],"sourcesContent":["import axios from 'axios';\n\nimport { config } from '../config/config';\n\nconst API_URL = config.API_URL;\n\nconst api = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Add token to requests\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\nexport const wishlistService = {\n  // Add to wishlist - save to both backend and localStorage\n  addToWishlist: async (product, userEmail) => {\n    try {\n      // Try to save to backend first\n      const response = await api.post('/wishlist/add', {\n        productId: product._id,\n        productName: product.name,\n        productPrice: product.price,\n        productImage: product.images?.[0] || ''\n      });\n      \n      // Update localStorage\n      const existingWishlist = JSON.parse(localStorage.getItem(`wishlist_${userEmail}`) || '[]');\n      if (!existingWishlist.find(item => item._id === product._id)) {\n        existingWishlist.push(product);\n        localStorage.setItem(`wishlist_${userEmail}`, JSON.stringify(existingWishlist));\n      }\n      \n      return response.data;\n    } catch (error) {\n      // Fallback to localStorage only\n      console.warn('Backend unavailable, saving to localStorage only:', error.message);\n      const existingWishlist = JSON.parse(localStorage.getItem(`wishlist_${userEmail}`) || '[]');\n      if (!existingWishlist.find(item => item._id === product._id)) {\n        existingWishlist.push({ ...product, isLocal: true });\n        localStorage.setItem(`wishlist_${userEmail}`, JSON.stringify(existingWishlist));\n      }\n      return { success: true };\n    }\n  },\n\n  // Remove from wishlist\n  removeFromWishlist: async (productId, userEmail) => {\n    try {\n      await api.delete(`/wishlist/remove/${productId}`);\n      \n      // Update localStorage\n      const existingWishlist = JSON.parse(localStorage.getItem(`wishlist_${userEmail}`) || '[]');\n      const updatedWishlist = existingWishlist.filter(item => item._id !== productId);\n      localStorage.setItem(`wishlist_${userEmail}`, JSON.stringify(updatedWishlist));\n      \n      return { success: true };\n    } catch (error) {\n      // Fallback to localStorage only\n      const existingWishlist = JSON.parse(localStorage.getItem(`wishlist_${userEmail}`) || '[]');\n      const updatedWishlist = existingWishlist.filter(item => item._id !== productId);\n      localStorage.setItem(`wishlist_${userEmail}`, JSON.stringify(updatedWishlist));\n      return { success: true };\n    }\n  },\n\n  // Get user wishlist\n  getUserWishlist: async (userEmail) => {\n    try {\n      const response = await api.get('/wishlist');\n      \n      // Merge with localStorage\n      const localWishlist = JSON.parse(localStorage.getItem(`wishlist_${userEmail}`) || '[]');\n      const backendIds = response.data.wishlist.map(item => item._id);\n      const localOnlyItems = localWishlist.filter(item => !backendIds.includes(item._id));\n      \n      return [...response.data.wishlist, ...localOnlyItems];\n    } catch (error) {\n      console.warn('Backend unavailable, using localStorage:', error.message);\n      return JSON.parse(localStorage.getItem(`wishlist_${userEmail}`) || '[]');\n    }\n  }\n};\n\nexport default wishlistService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}